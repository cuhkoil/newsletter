<link rel="import" href="bower_components/polymer/polymer.html">
<!--link rel="import" href="bower_components/post-service/post-service.html"-->
<link rel="import" href="feed-service.html">
<link rel="import" href="event-list.html">

<polymer-element name="issue-list" attributes="show">
    <template>
        <style>
            :host {
            }
            .issue-list h2{
                text-align: center;
            }
            .issue-list h2 small{
                color: gray;
                font-size: 0.7em;
            }
            .issue-list h2 small a{
                color: gray;
            }
        </style>

        <!-- add markup here -->
        <feed-service id="service"
                      feeds="{{feeds}}"
                      orderby="{{order_by_id}}"
                      url="https://spreadsheets.google.com/feeds/list/1RXKzcnJhsm88-T-3DikGpRsOa1NJ8AVhMSHzPYaf8CI/od6/public/values?alt=json">
        </feed-service>
        <div class="issue-list">
            <template repeat="{{feed in feeds}}">
                <h2>~Issue {{feed.gsx$date.$t}}~
                    <br>
                    <small>Links:
                        <a href="issue/{{feed.gsx$id.$t}}.html">[HTML]</a>
                        <a href="{{feed.gsx$editurl.$t}}.html">[GDoc]</a>
                    </small>
                </h2>
                    <event-list url="{{feed.gsx$url.$t}}">
                    </event-list>
                <hr>
            </template>
        </div>

    </template>

    <script>
        Polymer('issue-list', {
            order_by_id: function(feed1, feed2){
                // The IDs of issues are in the format: yyyymmdd
                // We sort in descending order of ID, so that latest issues appear first
                // Refer:
                // http://stackoverflow.com/questions/2466356/javascript-object-list-sorting-by-object-property
                console.log('order_by_id');
                if (feed1.gsx$id.$t == feed2.gsx$id.$t){
                    return 0;
                } else if (feed1.gsx$id.$t > feed2.gsx$id.$t){
                    return -1;
                } else {
                    return 1;
                }
            },
            applyAuthorStyles: true
        });
    </script>

</polymer-element>
